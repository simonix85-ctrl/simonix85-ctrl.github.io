<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <title>Underpiedi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              display: ['Orbitron', 'sans-serif'],
            },
            colors: {
              neon: {
                blue: '#00f3ff',
                pink: '#ff00ff',
                purple: '#bc13fe',
                green: '#0aff00',
              },
              dark: {
                bg: '#0f172a',
                card: '#1e293b',
              }
            },
            animation: {
              'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'float': 'float 6s ease-in-out infinite',
              'fadeIn': 'fadeIn 0.5s ease-out',
            },
            keyframes: {
              float: {
                '0%, 100%': { transform: 'translateY(0)' },
                '50%': { transform: 'translateY(-20px)' },
              },
              fadeIn: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #0f172a;
        color: white;
        overflow-x: hidden;
      }
      .glass-panel {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }
      .card-preserve-3d {
        transform-style: preserve-3d;
      }
      .card-backface-hidden {
        backface-visibility: hidden;
      }
      .rotate-y-180 {
        transform: rotateY(180deg);
      }
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #0f172a;
      }
      ::-webkit-scrollbar-thumb {
        background: #334155;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #475569;
      }
    </style>
    
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?deps=react@18.2.0",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0?deps=react@18.2.0",
        "canvas-confetti": "https://esm.sh/canvas-confetti@1.9.2"
      }
    }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <div id="error-container" style="color: red; padding: 20px; font-family: monospace; display: none;"></div>

    <script>
      window.onerror = function(message, source, lineno, colno, error) {
        const container = document.getElementById('error-container');
        if (container) {
          container.style.display = 'block';
          container.innerHTML += `<div>Error: ${message}</div><div>Source: ${source}:${lineno}</div><pre>${error ? error.stack : ''}</pre>`;
        }
      };
    </script>

    <script type="text/babel" data-type="module" data-presets="react">
      import React, { useState, useEffect } from 'react';
      import ReactDOM from 'react-dom/client';
      import { 
        Trophy, Users, Settings, Plus, X, Timer, VenetianMask, HelpCircle, 
        Eye, EyeOff, User, Skull, Crown, AlertTriangle, Home, Trash2, RotateCcw
      } from 'lucide-react';
      import confetti from 'canvas-confetti';

      // ==========================================
      // CONSTANTS & ENUMS (JS)
      // ==========================================
      const Role = {
        CIVILIAN: 'CIVILIAN',
        UNDERCOVER: 'UNDERCOVER',
        MR_WHITE: 'MR_WHITE'
      };

      const GamePhase = {
        SETUP: 'SETUP',
        PASS_PHONE: 'PASS_PHONE',
        GAMEPLAY: 'GAMEPLAY',
        GAME_OVER: 'GAME_OVER'
      };

      // Chiavi per il salvataggio locale
      const STORAGE_KEY_PLAYERS = 'undercover_saved_players';
      const STORAGE_KEY_SETTINGS = 'undercover_saved_settings';
      const STORAGE_KEY_LEADERBOARD = 'undercover_neon_leaderboard';
      const STORAGE_KEY_USED_WORDS = 'undercover_used_words_v1';

      const WORDS_DB = [
        // --- CIBO & CUCINA (NUOVI) ---
        { civilian: "Pandoro", undercover: "Panettone" },
        { civilian: "Tiramisù", undercover: "Profiterole" },
        { civilian: "Lasagna", undercover: "Cannelloni" },
        { civilian: "Polpetta", undercover: "Polpettone" },
        { civilian: "Tonno", undercover: "Salmone" },
        { civilian: "Miele", undercover: "Marmellata" },
        { civilian: "Yogurt", undercover: "Budino" },
        { civilian: "Pistacchio", undercover: "Mandorla" },
        { civilian: "Griglia", undercover: "Barbecue" },
        { civilian: "Prosecco", undercover: "Spritz" },
        { civilian: "Mojito", undercover: "Gin Tonic" },
        { civilian: "Acqua Naturale", undercover: "Acqua Frizzante" },
        { civilian: "Rosmarino", undercover: "Salvia" },
        { civilian: "Aglio", undercover: "Cipolla" },
        { civilian: "Fragola", undercover: "Lampone" },
        { civilian: "Pera", undercover: "Mela" },
        { civilian: "Parmigiano", undercover: "Pecorino" },
        { civilian: "Cozze", undercover: "Vongole" },
        { civilian: "Wurstel", undercover: "Salsiccia" },
        { civilian: "Patatine Fritte", undercover: "Chips" },
        { civilian: "Olio", undercover: "Aceto" },
        { civilian: "Sale", undercover: "Pepe" },
        { civilian: "Zucchero", undercover: "Dolcificante" },
        { civilian: "Spaghetti", undercover: "Rigatoni" },
        { civilian: "Tortellini", undercover: "Ravioli" },
        { civilian: "Gambero", undercover: "Scampo" },
        { civilian: "Limone", undercover: "Lime" },
        { civilian: "Banana", undercover: "Platano" },
        { civilian: "Pomodoro", undercover: "Peperone" },
        { civilian: "Melanzana", undercover: "Peperone" }, // Alternativa
        { civilian: "Patata", undercover: "Carota" },
        { civilian: "Basilico", undercover: "Prezzemolo" },
        { civilian: "Cioccolato Fondente", undercover: "Cioccolato al Latte" },
        { civilian: "Pancetta", undercover: "Guanciale" },
        { civilian: "Crepes", undercover: "Pancake" },

        // --- OGGETTI DI CASA & QUOTIDIANI (NUOVI) ---
        { civilian: "Cuscino", undercover: "Guanciale" }, // Inteso come oggetto letto
        { civilian: "Pettine", undercover: "Spazzola" },
        { civilian: "Shampoo", undercover: "Bagnoschiuma" },
        { civilian: "Valigia", undercover: "Zaino" },
        { civilian: "Ombrello", undercover: "Impermeabile" },
        { civilian: "Candela", undercover: "Lampadina" },
        { civilian: "Tappeto", undercover: "Zerbino" },
        { civilian: "Sedia", undercover: "Sgabello" },
        { civilian: "Chiave", undercover: "Lucchetto" },
        { civilian: "Dentifricio", undercover: "Collutorio" },
        { civilian: "Accendino", undercover: "Fiammifero" },
        { civilian: "Lavatrice", undercover: "Lavastoviglie" },
        { civilian: "Scopa", undercover: "Aspirapolvere" },
        { civilian: "Forbici", undercover: "Tagliaunghie" },
        { civilian: "Armadio", undercover: "Cassettiera" },
        { civilian: "Coltello", undercover: "Taglierino" },
        { civilian: "Piatto", undercover: "Ciotola" },
        { civilian: "Padella", undercover: "Pentola" },
        { civilian: "Forno", undercover: "Microonde" },
        { civilian: "Frigorifero", undercover: "Freezer" },
        { civilian: "Coperta", undercover: "Piumone" },
        { civilian: "Lenzuolo", undercover: "Tovaglia" },
        { civilian: "Tavolo", undercover: "Scrivania" },
        { civilian: "Sapone", undercover: "Detersivo" },
        { civilian: "Profumo", undercover: "Deodorante" },
        { civilian: "Orologio", undercover: "Sveglia" },
        { civilian: "Borsa", undercover: "Portafoglio" },
        { civilian: "Gomma", undercover: "Sbianchetto" },
        { civilian: "Quaderno", undercover: "Diario" },
        { civilian: "Giornale", undercover: "Fumetto" },
        { civilian: "Busta", undercover: "Pacco" },

        // --- ANIMALI (NUOVI) ---
        { civilian: "Rana", undercover: "Rospo" },
        { civilian: "Cammello", undercover: "Dromedario" },
        { civilian: "Polpo", undercover: "Calamaro" },
        { civilian: "Corvo", undercover: "Merlo" },
        { civilian: "Vipera", undercover: "Biscia" },
        { civilian: "Zanzara", undercover: "Mosca" },
        { civilian: "Mucca", undercover: "Toro" },
        { civilian: "Panda", undercover: "Orso" },
        { civilian: "Cigno", undercover: "Oca" },
        { civilian: "Gorilla", undercover: "Scimmia" },
        { civilian: "Criceto", undercover: "Cavia" },
        { civilian: "Formica", undercover: "Termite" },
        { civilian: "Gallo", undercover: "Gallina" },
        { civilian: "Squalo", undercover: "Orca" },
        { civilian: "Topo", undercover: "Ratto" },
        { civilian: "Coniglio", undercover: "Lepre" },
        { civilian: "Volpe", undercover: "Lupo" }, // Lupo già usato con Cane, ma ok qui
        { civilian: "Cervo", undercover: "Alce" },
        { civilian: "Pappagallo", undercover: "Canarino" },

        // --- LUOGHI & NATURA (NUOVI) ---
        { civilian: "Ascensore", undercover: "Scale mobili" },
        { civilian: "Sauna", undercover: "Bagno Turco" },
        { civilian: "Stadio", undercover: "Arena" },
        { civilian: "Zoo", undercover: "Circo" },
        { civilian: "Cantina", undercover: "Soffitta" },
        { civilian: "Balcone", undercover: "Terrazzo" },
        { civilian: "Bar", undercover: "Pub" },
        { civilian: "Farmacia", undercover: "Ospedale" },
        { civilian: "Discoteca", undercover: "Concerto" },
        { civilian: "Campeggio", undercover: "Picnic" },
        { civilian: "Grotta", undercover: "Caverna" },
        { civilian: "Isola", undercover: "Penisola" },
        { civilian: "Ponte", undercover: "Viadotto" },
        { civilian: "Vulcano", undercover: "Cratere" },
        { civilian: "Cascata", undercover: "Fiume" },
        { civilian: "Prato", undercover: "Giardino" },
        { civilian: "Aeroporto", undercover: "Stazione" },
        { civilian: "Chiesa", undercover: "Cattedrale" },
        { civilian: "Castello", undercover: "Fortezza" },

        // --- MESTIERI (NUOVI) ---
        { civilian: "Barbiere", undercover: "Parrucchiere" },
        { civilian: "Idraulico", undercover: "Elettricista" },
        { civilian: "Giudice", undercover: "Avvocato" },
        { civilian: "Pittore", undercover: "Scultore" },
        { civilian: "Cameriere", undercover: "Barista" },
        { civilian: "Soldato", undercover: "Poliziotto" },
        { civilian: "Attore", undercover: "Regista" },
        { civilian: "Cantante", undercover: "Musicista" },
        { civilian: "Medico", undercover: "Infermiere" },
        { civilian: "Dentista", undercover: "Igienista" },
        { civilian: "Cuoco", undercover: "Pasticcere" },
        { civilian: "Pilota", undercover: "Autista" },
        { civilian: "Maestro", undercover: "Professore" },
        { civilian: "Architetto", undercover: "Ingegnere" },
        { civilian: "Giornalista", undercover: "Scrittore" },

        // --- ABBIGLIAMENTO (NUOVI) ---
        { civilian: "Felpa", undercover: "Maglione" },
        { civilian: "Jeans", undercover: "Pantaloni" },
        { civilian: "Cappotto", undercover: "Giacca" },
        { civilian: "Guanti", undercover: "Muffole" },
        { civilian: "Calzini", undercover: "Calze" },
        { civilian: "Cintura", undercover: "Bretelle" },
        { civilian: "Cappello", undercover: "Berretto" },
        { civilian: "Occhiali da sole", undercover: "Occhiali da vista" },
        { civilian: "Bikini", undercover: "Costume intero" },
        { civilian: "Papillon", undercover: "Cravatta" },
        { civilian: "Gonna", undercover: "Vestito" },

        // --- PERSONAGGI & POP CULTURE (NUOVI) ---
        { civilian: "Super Mario", undercover: "Luigi" },
        { civilian: "Barbie", undercover: "Bratz" },
        { civilian: "Topolino", undercover: "Paperino" },
        { civilian: "Shrek", undercover: "Fiona" },
        { civilian: "Yoda", undercover: "Darth Vader" },
        { civilian: "Homer Simpson", undercover: "Peter Griffin" },
        { civilian: "Messi", undercover: "Ronaldo" },
        { civilian: "Ferrari", undercover: "Lamborghini" },
        { civilian: "Nike", undercover: "Adidas" },
        { civilian: "Pikachu", undercover: "Charizard" },
        { civilian: "Gandalf", undercover: "Silente" },
        { civilian: "Thor", undercover: "Loki" },
        { civilian: "Spongebob", undercover: "Patrick" },
        { civilian: "Naruto", undercover: "Goku" },

        // --- CONCETTI ASTRATTI (NUOVI) ---
        { civilian: "Bugia", undercover: "Segreto" },
        { civilian: "Paura", undercover: "Ansia" },
        { civilian: "Fortuna", undercover: "Destino" },
        { civilian: "Talento", undercover: "Genio" },
        { civilian: "Rumore", undercover: "Suono" },
        { civilian: "Caldo", undercover: "Afoso" },
        { civilian: "Veloce", undercover: "Rapido" },
        { civilian: "Ricco", undercover: "Benestante" },
        { civilian: "Guerra", undercover: "Battaglia" },
        { civilian: "Passato", undercover: "Futuro" },
        { civilian: "Vittoria", undercover: "Trionfo" },
        { civilian: "Errore", undercover: "Sbaglio" }
      ];

      // ==========================================
      // UTILS
      // ==========================================
      const shuffleArray = (array) => {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
      };

      const getLeaderboard = () => {
          const stored = localStorage.getItem(STORAGE_KEY_LEADERBOARD);
          if (!stored) return [];
          try {
              const data = JSON.parse(stored);
              return Object.values(data).sort((a, b) => b.wins - a.wins);
          } catch (e) {
              return [];
          }
      };

      const updateLeaderboard = (winners, allPlayers) => {
          const stored = localStorage.getItem(STORAGE_KEY_LEADERBOARD);
          let data = stored ? JSON.parse(stored) : {};

          allPlayers.forEach(player => {
              if (!data[player]) {
                  data[player] = { name: player, wins: 0, matches: 0 };
              }
              data[player].matches += 1;
              if (winners.includes(player)) {
                  data[player].wins += 1;
              }
          });

          localStorage.setItem(STORAGE_KEY_LEADERBOARD, JSON.stringify(data));
      };

      const getNewWordPair = () => {
        const storedUsed = localStorage.getItem(STORAGE_KEY_USED_WORDS);
        const usedIndices = storedUsed ? JSON.parse(storedUsed) : [];
        
        const availableIndices = WORDS_DB.map((_, index) => index).filter(
          index => !usedIndices.includes(index)
        );

        if (availableIndices.length === 0) {
          return null;
        }

        const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
        usedIndices.push(randomIndex);
        localStorage.setItem(STORAGE_KEY_USED_WORDS, JSON.stringify(usedIndices));

        return WORDS_DB[randomIndex];
      };

      const resetUsedWordsHistory = () => {
        localStorage.removeItem(STORAGE_KEY_USED_WORDS);
      };

      // ==========================================
      // COMPONENTS
      // ==========================================

      // --- Button ---
      const Button = ({ 
        children, 
        variant = 'primary', 
        fullWidth = false, 
        className = '',
        ...props 
      }) => {
        const baseStyles = "px-6 py-4 rounded-xl font-display font-bold text-sm tracking-wider uppercase transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg";
        
        const variants = {
          primary: "bg-gradient-to-r from-neon-blue to-blue-600 text-white shadow-neon-blue/30 hover:shadow-neon-blue/50 border border-white/10",
          secondary: "bg-white/10 text-white hover:bg-white/20 border border-white/10 backdrop-blur-md",
          danger: "bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-red-500/30 hover:shadow-red-500/50",
          ghost: "bg-transparent text-gray-400 hover:text-white"
        };

        return (
          <button 
            className={`${baseStyles} ${variants[variant]} ${fullWidth ? 'w-full' : ''} ${className}`}
            {...props}
          >
            {children}
          </button>
        );
      };

      // --- SetupScreen ---
      const SetupScreen = ({ onStartGame }) => {
        // --- 1. CARICAMENTO GIOCATORI SALVATI ---
        const [players, setPlayers] = useState(() => {
            const saved = localStorage.getItem(STORAGE_KEY_PLAYERS);
            return saved ? JSON.parse(saved) : [];
        });

        const [inputValue, setInputValue] = useState('');

        // --- 2. CARICAMENTO IMPOSTAZIONI SALVATE ---
        const [settings, setSettings] = useState(() => {
            const saved = localStorage.getItem(STORAGE_KEY_SETTINGS);
            if (saved) {
                const parsed = JSON.parse(saved);
                // MIGRATION: Convert old boolean mrWhiteEnabled to number mrWhiteCount if needed
                if (typeof parsed.mrWhiteEnabled !== 'undefined') {
                    parsed.mrWhiteCount = parsed.mrWhiteEnabled ? 1 : 0;
                    delete parsed.mrWhiteEnabled;
                }
                // Ensure mrWhiteCount exists
                if (typeof parsed.mrWhiteCount === 'undefined') parsed.mrWhiteCount = 1;
                return parsed;
            }
            return {
                mrWhiteCount: 1,
                undercoverCount: 1,
                timerEnabled: true,
                timerDuration: 60
            };
        });

        const [activeTab, setActiveTab] = useState('setup');
        const [leaderboard, setLeaderboard] = useState([]);

        useEffect(() => {
          setLeaderboard(getLeaderboard());
        }, [activeTab]);

        // --- 3. SALVATAGGIO AUTOMATICO IMPOSTAZIONI ---
        useEffect(() => {
            localStorage.setItem(STORAGE_KEY_SETTINGS, JSON.stringify(settings));
        }, [settings]);

        // --- 4. SALVATAGGIO AUTOMATICO GIOCATORI ---
        useEffect(() => {
            localStorage.setItem(STORAGE_KEY_PLAYERS, JSON.stringify(players));
        }, [players]);


        const addPlayer = () => {
          if (inputValue.trim() && !players.includes(inputValue.trim())) {
            const newPlayers = [...players, inputValue.trim()];
            setPlayers(newPlayers);
            setInputValue('');
          }
        };

        const removePlayer = (index) => {
          const newPlayers = players.filter((_, i) => i !== index);
          setPlayers(newPlayers);
        };

        // --- RESET FUNCTIONS ---
        const handleClearPlayers = () => {
          if (players.length === 0) return;
          if (window.confirm("Sei sicuro di voler CANCELLARE tutti i giocatori dalla lista?")) {
            setPlayers([]);
          }
        };

        const handleClearLeaderboard = () => {
          if (window.confirm("Sei sicuro di voler AZZERARE completamente la classifica? Questa azione non è reversibile.")) {
            localStorage.removeItem(STORAGE_KEY_LEADERBOARD);
            setLeaderboard([]);
          }
        };

        const handleStart = () => {
          const totalImpostors = settings.undercoverCount + settings.mrWhiteCount;
          if (players.length < 3) return;
          if (totalImpostors >= players.length) return; 
          if (totalImpostors === 0) return; 

          onStartGame(players, settings);
        };

        const formatTime = (seconds) => {
          const m = Math.floor(seconds / 60);
          const s = seconds % 60;
          return `${m}:${s.toString().padStart(2, '0')}`;
        };

        const totalImpostors = settings.undercoverCount + settings.mrWhiteCount;
        const isValidConfig = players.length >= 3 && totalImpostors > 0 && totalImpostors < players.length;

        return (
          <div className="flex flex-col h-full w-full max-w-5xl mx-auto relative z-10 p-4 md:p-8 bg-dark-bg/50 md:bg-dark-bg/0">
            {/* Header */}
            <div className="text-center mb-10 pt-4">
              <h1 className="font-display text-4xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-neon-blue via-white to-neon-pink drop-shadow-[0_0_25px_rgba(0,243,255,0.4)] animate-pulse-slow break-all">
                UNDERPIEDI
              </h1>
              <p className="text-gray-400 text-xs md:text-sm tracking-[0.6em] mt-2 uppercase font-bold">Neon Edition</p>
            </div>

            {/* Aggiunta delle immagini dei piedi */}
            <div className="flex justify-center gap-6 mt-8">
              <img 
                src="data:image/jpeg;base64,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" 
                alt="Piede con smalto bianco 1" 
                className="w-28 h-28 md:w-32 md:h-32 object-cover rounded-2xl border-2 border-neon-blue/30 shadow-lg shadow-neon-blue/20 rotate-[-5deg]"
              />
              <img 
                src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMSEhITEhIVFhUXFxUWFxUVGBcXFxcXFxgWFxcXGBgYHSggGBolHRUXITEhJikrLi4uFx8zODMtNygtLisBCgoKDg0OFw8QFy0dHR0tKy0rLSsrLSstKy0tLS0tKy0rLS0tLS0tKysrLSsrKy0tKy0tLSsrLSstKy0tKystLf/AABEIAPkAygMBIgACEQEDEQH/xAAcAAACAwEBAQEAAAAAAAAAAAAEBQIDBgEABwj/xABAEAABAwIEAwUGBQIFAgcAAAABAAIRAyEEEjFBBVFhBiJxgfATMpGhscFCUtHh8RRyIzNigrKSwgc0Q1NjouL/xAAZAQADAQEBAAAAAAAAAAAAAAAAAQIDBAX/xAAhEQEBAQEAAwEAAwADAAAAAAAAAQIRAyExEgRBURNhcf/aAAwDAQACEQMRAD8A+o1sdyQzsY5FHCBUvw6QQGKlSbUlUPpQqauJDB1QF2MxeULP4qvJK7ia5cgKtRAQrPi6iyqqKlRDOqKenwT7bXxVHtYKodUVbnpdMc7FoapWJKoY4mwCZ8LwJe8CJn5/sl9Bn2V4B7V4e8WHNfQWMbTENAsqsDhhSpho1hWkLSTiHnVUO6svPCrcmaXtl0Vgh3FRlAX+2XPaE2C9Rw+ZEuqMZYaoD1LCTdyvAY1Lq2NJ3Q1TEc0gdHGtBsAqTxMXskFXHAIGvxPkl0NQ/ig5BAv4oZNtzyWVrYwzqg3Y8yUdHG8fihzQ1XEpG545qh9VANa+I6pfWqhCGqhKle6AJrVkDWqKFSsh3uStU69yoc5SIURTUhS9y4yiXIylQnZNeHYSTcJyDoTA4LQfytfwXABrmmOSFo8Ph/0WiwlGACrkTTFwkr2VdadPBSLkyDVGIR7UxqNQ1RqDBGmVbRpc1NzuaAxOLJOVqVoFV8bFmoN75VUwqaj0uhZUqwgq1bqovqoao6UgjVrG6HqOJVrwqHjkg1L2bhVOw4lH+z0UXa7I4FdSsomoolUuT6EqlS6HJVrWyvUrkiEgHK8GdPijmYR2uglRFAk9EcPoMNVtLDkmIhNcLw/UxpdMKGEABPP19U/yXQeEwFkzwGGgqdFsK6m6CCmQ91OC1MGM2QLXAkEbJnTMhBJNbZVYl0BXtVdenZAC0MaDYqdVyyvaCq6g9rhobK6t2iFOjmN3aNHM/oErri5m34t45xinQEvdfZouT+gWb4d2uoVHlg97lmE/BYvtNxN7pc4y55gTzO/gBfyWJe6XmPD4WWV1b7d3h/jZ16r9DVMQIkIH2hebaL5/2Z4viTRrjPLMPh61TvScz9WBxJvF4iLWTLsZ2mr1nhlVjSx0gPa0thwEwToZ5apTf+n5f4G82898ax5iwVT3q3EQEKXrTrh4II06ruXZQovkBTLoCIXEK78psqXZZ1VOKxCWuzToUdHBzaCsZRCKdRPJcNHyVksp4cZSpYTBhrh6sqsPXym9x80RjHZQHNMjY9OXighmIoQLafsVDDYRRwWNFRt/DzRrXoCuoyC0DQ2KIcy0clENlwRQo6SmFXs7aId4PwRVRxBvogcZiQAUgjhuKhr8h6LX4Z0tBXyd9cmpm6r6RwHE5qY8AgU2DV5yiXWkoGtjRMIDOdvxFOmf9f2KwWOxJcByFh91tP8AxAq9ykP9RPwH7rC1RDW84Cw8t9urwT0R9oKLnBr2gnKHDKNZMd6N9/isxhKBJAGq+mYGgHarQcPwbGS9wbAkkuDbADWSOSw/5f6eh4NTHvhJ2ewJw2Fhwh9YgQdcouZ+nmEy4hTbh8MarWjMwtyjS73NBjlO5HJA0eIf1Nc1PwizAdcvMjmdfgNkX2vBFLDs0Dnlx/2i3/KfJZfq/o96ur2/2zXDu0WIq4l9J+TI1r3vJaSWtYwuMAOFyQGgc3BaurSLLHVQ4XwLDPqe3ezvgDMZIDogjMAYd7oN+Q5K7FVvaFzhz05DaV0Y31zeeZsnI5QfC9WrWUHWsq3NzQFtK4tRChSLii3MvqrC4UxA13QDnGSgjXEuaPxEnkh6jHNALh3Tvy8VXQplzr+C2lDh7XUg3WyviWLq0TqD5qpuIc2Wu0KdYnAmkS0ju7dFT/Rh0goBZhqmUyDYpszE6EeaWYjBupnovU6kaI6ONLgq4OvNOC/ZYzC4iCLp7hsbIAOqrqRePIg9FkOI4rUErQ8WxQDSsVUcXuKVpyO0hK+idl2n2YnksRh6N2t6r6Bh8OQwMbyE9ByRBUcdi8xgGyDbVAPVGVsIGi8pRj6jWAmUW8OQh7c4rM6k3kHfOI+iy3EDoOQRfEq5q128hLj4Cw+ZQOPcubd7XZ4s8hx2dpZ0f2qrinQqNG7cviX2+QkqjsfTlpPJIO0/FfbVKjBox5HiR3fsVzz7a6bPkX9kGzUk6Jz2mrCpVoUh+EEu6ZogfBs+YQPZhgY0vdZrQXE9AJKD4HjDVrPqPF3Ek9J0HkLeSm/6qnvG63saDWtsahy/7QJd9h5rJYLgdb+sdUyFzHNIpvBENLobLgTPdBc4CPeDdpTjtZis1WjTb+FpJ8XxA+DfmjsFj/ZtJcYa1pKvN4JriupVgm+hK4MYQgK9fqqm1F0xw6Mv6mdVU7EXQocolpVdRxr8FSvdaXhmIWewqb4M8gtnOc4vDNqDqs9UwxY6E/pPXMXSDxfVIyjHYeW3GyzGJZlJWn4jicoyrL4ytmMDUqaqKRVRmGx2XVCuwZAQxkJdAriOPL1VgqO6jSoyU9w+FZSZ7avamNG7vPIJnxbwHhxc9r3CGzbqtdUqZY5rFcK7XU6rpcWMptmIOaI2kalK+0//AIjOpmKVNokSz2kyY3IBGvKUfqRePBveuSPpFd0iVgO1OMyuLU67M9oXYjDF9dgpuaJdEkbG03B7wtqDI2XzztrxRj6pLXnUAiNt7zqo1uWNcfx9/v8APPgnCs7rqh1dp/aNPqT5pbjnJhVrgsYWnuloIPMevok+Kuud0fnnptOxropOWe7QcHyVahbo5+YecT85Tzsm/wDwnDwUuLjN5LDvutCrFSMG9rfedDfKb/K3mhuGEUKbqj9GiT1Ow8SYCNLbQlfaT/KawbuBI8P3VT2m0FhMWX1C92rjJ9dBA8k6x9VjmNY6+YgkdAZ+sLPUMtNpc7b1CrpYwlxcdfoNgtOe+laPpvMkciVeHIKk/c7oygJK2jlv0bhmSiTSXaIDQq3VrpprRseWpngcaJiUHWiEneXtdLbhbdc/H0GkZH3VrCUg7O8UD+67XqtXTYDBVEX4/hTarYccpOjhr+6ylTg78NWa6q3PSuM4GkiASNo+C2HEpygjZUsxwLe95pWQ5WExeLrUHHvCqwnQ/rsh38TpPE+4dwUT2hNPMchjmNvLksnjKgAJKxuuN84/R4ztFSpvDWtFR+oaTA/uI1IXOOivjabpqd/a3cA/KGjQddfFZzhXDhnLhOZ8Ek7DZo+v8LS8TxX9LRgXe+zZ+Z8Ast7veR0YxM+2J4NhH06jg9wsbhswToJ56L6BwnhdPENAqsa9o/MAY6jkkfZ/h+c3vuTzPNN+PcZ/pQMPQMVHNlzv/babT/cdlnrVtb9ve/25xviYFT+mow2lTAa6NC8kOjygeZ6Iar2cpVy2oW98fB39zd/21U+B8MDxp1J1JOpJO6O7TcTGDo5GXqVJawfVx5AKJb30uaufcZbHcQpsilJPsyWk2lznHMQNhc6dUBS4lh3vLHudTOmcw9k/6oAI8RKzOMrOzuue7vuXHU+N1VhBcTpv4bre55Gvi8c8mvb6/wAApOpBzHRcAggy1wOjmncK7FBV8GznBsq1Cczqj332FQzlHIaWXar5XLfrPefzbANRK8eJ1TSqlePKqMtM7xRpJYPwiSfHQfdRpndW4sIap+EdV0RjTCkZTjCNgJXgQtDw/CZoJ0+qtlRGBwpqG+nP9EzODZ+ULzagaICHdiblNDVVuAOee6YHVNeG9nmUhe5RdPE3gK8XXRxzsR2hwX9NVFRlmk3jYrWcExYqUgZ2QHaTCCpSc3fUJR2SxmR4Yd7eY/ZKfTafFVcrTKwPFuKGXAGy0/a3Heypu5my+cEF8ucYb8yo8muNfHjqvEuLtDqlHGSCadMauIB8N/lK0GDaDmebNaCsrh81WtUrH3R3WDpu7z0+K5u9vXVJycaPg9OD7Q6fZLsfjf6zES33GdxvUz3j9lfxXElmHyM999h0G5XuzGBFMAct/qVHfVrQ7oYtmCouqVNtBu5x0A6rP4XCvxD31H++8yenIDoBZR4nmxWIEf5dMw0bTu5bLs7w4NAJCm3k/wC1z/VuDxDMJQNSqcrWi/MnYAbk8lgOIcQdiqzqzhE2Y38rRoPXVW9u+MnFYhtGkf8ABpzBGjn6Oeeg0HnzXeGYAkCBYWCfPzPf2pmv1f8AwNi+zorXByOMX1B/uH3CqwfY3EZhnDckiXB0yOQGq3GAowQCnDcKBfZE3W2PJcfAvFagpUaNIak6dGi/zIS5rpSjifFfbYwhp7jP8NvWLuPxJH+0Jix11nqJtRrJPjnJxXNkkxpVZRooxJuhNXADZXYgxJXOEx7x1K3yw1T7hWEiC74JzUxrWC58Bv5BLcIHO6D5pthMO0XDRPPU/HVWzoZlerU9xhA5x99F08Oq8vmE5pvUHPuU+IrZNqEEnVM8PV52SDB46bEXieXy+Hx6iYV+JlxyjWJgcua6eOaXonjGPzODWnRL+EYLPVzGwacxPgVxtGbylfaPtIKNM0qJubE7qbeKk6E7YcVFauWtPcZr1KR4irNkFhKhgudqTK97WSuXd7XbicgzEVCWezGh1S5/dho80U+pA6qmmzcrKNUvZz33eQV1NxPdb5qprS93ROMFRDVOqqQdwvh7WgAC6u7VY32NA06Z77xBI1AOoHVUf1JbdLMTTfiHx68FE+9VSDhfDSTAHjyHQLc8OwAYyN/X7K/h3Dm02wBfmi6TMqdvR8DNp3WY7V9qck4eiZqaOcNGf/rorO3HaX2A9jRP+M8a/kb+bxO3x8cFhaUXNybkm5JOpJWmccnazuu014QIeFrA7RZTh4ghaOmdEtLlE1dEpxbNU4Isl2KGqmCstxMw1yl2cfnOmmynxVn1Cr4KMlYciunPxza+tzhqNkbSYuYZlgimU02drtNig5lyiGtVThcpkrocRe5zTmgkEOOuUDJA0gXcPNdw9bLVa29oL5OjWgOdfXc36Ko0xYiROmXnNr7G8eMHqqH4dzS9zTJDWhwMBxgzIsZJAFjydquz04vcGY3iDjYAxpbQb3O9tgkdThXt6r2skTmPeHugTAcefT+ETQqua7M4ZRBIA96czRc6A5crQRvf8S7hTTcXSbmZdJuTm0nqI6QNnSpuJVzyWEOMpuY4scIItHrZUtW5oYXDu/xX5bZJde9h7k6yCNBukFfAtzueR3C4gES1jcpg94jvEaGBr1XPrw3+nVn+RP7LGtnVSySm2PoteQ6kDlJDGi8kNaLxrsVRSwx5Ln3m5rpxqanXsJQR1ML1GimFDBlYWt5AbcOXmE2w2EazxRNOgG+K6WJfRXadku45xFtCk57thYczsEye8NC+Z9uOLe0qZAe6z5u3+GnxWvjx2svJvkZV1d1aq59Qy5xk/oOiYBuiWYV0vKbbBbb+s/H7grBnvBaGk6wWcoSCDBjmneCrhwgXggfp9FnZa0/UhkHWQmIKvY7X4IXElTw7SDiZv5hXcOws1Gwg+IVO8PEfVaTg7AADut8/HPv60mGFgjKYQGHcjablTMS1qqc25VrSq3OuUyB0Wc9+psNB9vh1CnoJvFwBb5RYn+RtNVN3jJvfTmJ2335rokaExre8bzM8/j5X6nIkGmZN5vIGpNuc3H2PiPVwzXEHLBEi4i9gYgibbncDxNgky64FwJsTG40iY8+Wym6xJccoPxiLQOn33sgAXUqjBDCDfMRYQ4CBoIOh+nKKczIFN2YAuzd4SRmzchBBznzbtMB1RYC4F0xM5TPXWNxEdJhRrMAHeAOsgREOMkfKec87JkTU6opU3NDgAGV3h4kgB1NrnMzb3Y4Dm107o3CSabMwvk8RLXNDoi0gOb81V/QkgDNlkABtstgWgOHWdNZI0i4rA5uRjnFhAeAJgRUaKb3OB1IBaZ0lp851ianF58lzetDhMILG3yTLIGgJDhC1ppMN25xHegEECGnmWjl1Oqd1ao8l5vm8H4r1PD/I/wCSIkoXEY0NQmP4jFgsR2k7RZJa0y87bDqf0U4xaN+Thv2j7Tik0hpl5FunVfMMZjS4n6qOIqOeSXEklGYPh7XQSblsweckDTbRdmMflyb3+qH4MwvqBukkXjRaOvhy2Nwd9OhVWFpNpsDGiCSC4n3rQ6B5/KVc+qCWhxmL5ryNY6etN074/wBFPLcm9CsKbXe0IIh3dbMmGuvc2MgQp4F2VrwWtnaIFiQBPWT8AeaWUKhNwCJEc7SIt0RGFoR3SSTbeNAR5gx00WkkjK20fhqxL2nMIygukSTvlidYi/iVJzBdxnLbcEEkSAI6EE2tK9hsO20saYjrbNDTPK5uR/1WCvPDxsS06ayLTseXOT4mMyLnNE3qMrxSiXu1AgiNYsdPDqnXCa8taUuxjZMOs6/1v42JXcLiWssNAs9Y40zvv1tMG6YTOmkXCa4ITykVKur2qt2pVgQ7n3KCQBa1rtdrn8XQu20iP5FTyXiZyskmN7XE9J36qbrwddDE78zbxHku0zqSLfIDy0XU5UabN3XOgERFt+vNX02A8wTudNdQNDsI5rtCl8pAv8TfkLyiTSAAaSBmvmiN9wOseQ5oCljQ4xaNjOhbtzvy6aqJaXQTIHS4JEw2drTbTTkra+XKQLCYsZLTAOadNdvmp02GYicoBgw2Z3bplPMfNMKi1sfm6gd5p5G1ogfAmNFRiKQlpfGhIe05rERNgCZgR13Rje7+IkxoDlqASZkR/iXOnj4oWrocsb5iwlhB5ezItv8AogqBpuBcGOMgZI2AAvpty30jaTa/FHKZcCOe5PgbjwKXcTxRa4Okm0BzQA515FzeYJt8NLqONcSc2kZcAYgRe/iNTz8As/LiajTw7uaB7QcbIJaw358lknCSSbk7qx75PMlWNYAJseXSIKzzjk9Ntb7U6GGADs29rXI5/X5IjOGCDBiINvj06oQVo8z6Mc9FfhqEgE+rfutOM+9XUS55sCBuZJ3NpPnfqjqOFAIOp6/XwXqcAIph+hI09fyl0nW2F9NCVbQFxztb4g7dNb7qsCdY8yevr+FbEH5dLSfr4x0QBlF02jW3yjnfYa9JPupu2CJ5ieQbGo8r7j3ZtGZibDukg85v3hOYX8SR4yPziwe4LvATYiw8QQJABm5c0WOrmkGTTcnCrL9osLf6EajoPQ8BdZjFvLSJtcX2PNb7tNh8zA4DYaQbbdIiANvAd0YPjLMzSNwSR68/RlAh72expIF9LLdYGrICwHZ2hkaJ1WxwFYLOxpDsCUO6ncq2hVU3ESpMHXBlxgyBNlZVNgBa9r38jcxqovaXXFxmAy2uRa/wRVU6ZgTtbUHTwXS5kaLO+e9J1kASbRM7tAKvqvJMAkl0G1mkc4EXF4uohxtMHXYgC+hOmk/BWU2zmE6xmImY5GIB0MEIDlOnJuDI0Iu6LghwIkiBHgrSBBAHdE5ol7TFrgHMx15noeS7YjMNBeLmAPxS0hzNOqjWqC3zfIcQNpc3LUaYNswO3VMIOuM0y1p7pJzMmLHMO+wjk4cktxlUnfXSYJb1DtXNmdUfVIAzROhBBBLpEkCo0Q4xPdcJMpJxKtAd11iwjwPPl0QGb41i7CLHMLe7YXv8vgstxTFgnYmNTd3Vd45xIucct4ta0lK8M3NBdN5Fvqpq8xF7rmFcamwJvyP2Q9Vly0fNX4elHKUjoihT336z65Jmy0+P8IOl6PyVzakDTr8P4SMaakevJXMrGIm+g85/SEvL4jw162sPW6lTcZ0vb18TCAa0Kljtb5gRsRJ21/ctoHdgdTtvAEWGvhe3dOolBkGLzB25g2+ZtvCJDrNtJ56g6wRzta+twbgIIVQ97zMi5IJJIiBMzFhBkWh4GZzh3WFgQDvHevoDYf8AqRbun2mzagLFOFuTexETc37wmdSIYOZIaT7zAmGCdaImHGzmiXZrCwMG7tNCahGlbuhUbiaQfTIM3uT0IJmeUTrGkmHNqr55xrBOpuyuHODseXx+fivplIj8JOsWOaZy3zO195kE7+zeYzVYV9oOGB7JjlIuBfSAbhsAwNRB5J0SsrhDYEJzg3pPhKWXu8tJ+/VNsK2FlWsOMNXKINdCYYIkhI19A+dtdY8RzRVIjLMHyiRy8TYKhlRvutm3KBmPVWYemQJtY6Dfe66HMIwuFIaJ0JsQe8L/AIunjzRDaRcADDQNTs4axE5BcnRwXsM8TmIgx3SJAAM2IkD5ooACAIacpM/CTIgn4uTK1U0ySSLC2XvGT/pLydI/C/8AeD3kT3pLZuc+YD+4w9nL8QXalrsib2ECZ2NgHTezgDdDVX85gSLWDeUNPuzuEEoxlaZJnQTpPg7LrBIg7ysB2t4nqxpgnXp4HxWj47xDK0mdhb4xr0I+C+eYx+Yknf1+yKqEtVjgY9eKup5o19C/rzUqgkqxzYHr16CVUFzyZ9aq1jkLTv5n91e2/rmpUNpOH0XZn169FDB/r14K1p0QBDHaBM8KzKJIvBIEfP5IfCYfLBdc2gax4jnP0RNR0w6Y59CB73xsQgLC4yPADWx1IuNJix2KsZVsM2s84Bk77Xv4Og7yhAbx8thM92eRMQfBX+01m4M3Mbki466HqAUgOoVogne0i17R0Dp+Dmg/iKc4TEhzXN0MAEmzYuZIOwbnMDRpeNabVnZEAajkfhBPKwB/tBR2FrGxmAN+VyZsbkZSY/M1w/HcDVUqpc1saiLua0gQCHZwLnSqSBqP6j8zExqUjextoHamSQQ6N+66f/kY6PeSPhuLEkF0N92BfKbFuXd0BogfiyU/zlPxW92ZsPwxYC3dt3oy92NTQYfx3cTWJ43g/ZVA4e6Tr0IspUXLR9psDnpOc28ZtLgERMdLyPELJcLrBwUajTFPcK9ElwQmHCtIUVY0tGxAcPkD9EZTJd3HQ2IOYHdB4ZtgALuEfuPXmnLKBb3bOgSbBdLlorLMmTIAHQtN9r/NccRyGhBAFvpe6tovkTNyIjaIQlZ9xJtcdbDqgkK1Yi1r2sDp15i+6VcRxAazy23id+W3krq7yJ6yBpcDrAJBA+SzfHeIGNb30I1P8/JAhBx7GZ3ETA+U+WwSWpaf05fx8giq1z6kGRf7fDmh6wtA6aetNNeiTQA1snb1KrxjoafP7j6+oKJYJNgbeXooTir4EeA8h6+fIpU4DpHkrWlDsdojMNQc8w2Op2+KSkqYzEACZ0CcYWgGQXXcI8rj4+PRcwlFtMWudzuY5cgpF0zyja83mx25+EoJJ0nzGgtMEG3JTpxJJJJ1nw3+xCg88zaSbcj+IeuS8SJueRHKSLE9LX8UBN0CBEQYA8SbeB1HJT9pJ6CD3t9tOuh/lV7TEj6xt8rKckwR89zrr1BHmkFzKhixnTXfUX6RYoltpAtoY1N40693/qZ1QrHl2t9bc9I6XHzUs5nU+fSL/fxagzfBYpwFhMO0bE3gd0nfkdopLXYCrmpgNMFpFxaGxMtnWzQ4bAUqXNYKjN76Cbct/v8A/RanhNUkZ7DJvpcwdBqJaDGzaQ5pypsa+lRsRYGAC2ZBiQNdrOaOjWlYHjnBzhqhez/Lcbj8pPL/AEkn4+K2+FrzTnaI3sbAg+WQf7HKPE8H7WnDhM6+Bt+nwRZ0peVjsJVlFmolOHaWOc06tMIw1Vk1aPCicxd3eR/n7/BMaMQHDWNTyS/8Df7kwwfuD+4Locy+s6GDmgsTUDWybwZkFFYrT4Jdi/dd63CAW8Qr5RO/QdIHyPzWL4jXzHpy11Hy/haXjWnrmsbxHQeDkKih3qORH8/TUBVYh2vxvBPPz39QrcZr/ud/2Iavp5fdqSnqTeev39ephKOLnvADl9PX8aJr+bz+yT8V/wAx3ifqinHMBhS8390an9Oqe0+6AG2AIsN9fn+yE4X/AJbfP/kEdT1+H1UmlSOtvpJ532Xm6GD16RpI9bqNH8Hj9yot0b65ICx5EeG2wIH0NlxsEgEcxA6aj1zUPwnw+6vdt/cEg4H/AFHw2P2UwSBqP03+RQ418j9QiXaD/d9AgJ0HWIJ5Anw1+ykb333jb0fqqaeh8/qr6Ovl9kBa0zodvp9dB/0p1wXFAG7bNEkbHSAfg0eDSkVPT4/9yOwuvkfo5Arb8FxYdMaTEnckG/U7eLytFRGZoGXYg3mf0H6rH8C9yn/e3/mtjw7/AC3eJVIYntdw80qraoHdqa9Hj9Uq9qtl28/8s3+9n1Kwyzv1rn4//9k=" 
                alt="Piede con smalto bianco 2" 
                className="w-28 h-28 md:w-32 md:h-32 object-cover rounded-2xl border-2 border-neon-pink/30 shadow-lg shadow-neon-pink/20 rotate-[5deg]"
              />
            </div>

            {/* Tabs */}
            <div className="flex justify-center gap-6 mb-8">
              <div className="bg-white/5 p-1.5 rounded-2xl inline-flex shadow-lg border border-white/5 backdrop-blur-sm">
                <button 
                  onClick={() => setActiveTab('setup')}
                  className={`px-8 py-3 text-sm md:text-base font-bold rounded-xl transition-all duration-300 ${activeTab === 'setup' ? 'bg-gradient-to-r from-neon-blue/20 to-blue-500/20 text-white shadow-lg border border-neon-blue/30' : 'text-gray-400 hover:text-white hover:bg-white/5'}`}
                >
                  GIOCA
                </button>
                <button 
                  onClick={() => setActiveTab('leaderboard')}
                  className={`px-8 py-3 text-sm md:text-base font-bold rounded-xl transition-all duration-300 ${activeTab === 'leaderboard' ? 'bg-gradient-to-r from-neon-pink/20 to-purple-500/20 text-white shadow-lg border border-neon-pink/30' : 'text-gray-400 hover:text-white hover:bg-white/5'}`}
                >
                  CLASSIFICA
                </button>
              </div>
            </div>

            {activeTab === 'setup' ? (
              <div className="flex-1 flex flex-col min-h-0 pb-28 md:pb-0">
                
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 h-full">
                  
                  {/* Player Input Column */}
                  <div className="glass-panel p-6 md:p-8 rounded-[2rem] flex flex-col h-full shadow-2xl border border-white/10">
                    <div className="flex justify-between items-center mb-5">
                      <h3 className="text-sm font-bold text-gray-400 uppercase flex items-center gap-2 tracking-wider">
                        <Users size={18} className="text-neon-blue" /> Giocatori ({players.length})
                      </h3>
                      {players.length > 0 && (
                        <button 
                          onClick={handleClearPlayers}
                          className="text-gray-500 hover:text-red-500 hover:bg-red-500/10 p-2 rounded-lg transition-colors flex items-center gap-2 text-xs uppercase font-bold tracking-wider"
                          title="Cancella tutti i giocatori"
                        >
                          <Trash2 size={16} /> Reset
                        </button>
                      )}
                    </div>
                    
                    <div className="flex gap-3 mb-8">
                      <input 
                        type="text" 
                        value={inputValue}
                        onChange={(e) => setInputValue(e.target.value)}
                        onKeyDown={(e) => e.key === 'Enter' && addPlayer()}
                        placeholder="Nome giocatore..."
                        className="flex-1 bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-white placeholder-gray-500 focus:outline-none focus:border-neon-blue focus:ring-1 focus:ring-neon-blue transition-all text-lg shadow-inner"
                      />
                      <button 
                        onClick={addPlayer} 
                        className="bg-gradient-to-r from-neon-blue to-blue-600 text-white rounded-2xl w-16 flex items-center justify-center shadow-lg shadow-neon-blue/20 hover:shadow-neon-blue/40 border border-white/10 transition-all active:scale-95 hover:scale-105 group"
                        aria-label="Aggiungi"
                      >
                        <Plus size={32} strokeWidth={3} className="group-hover:rotate-90 transition-transform duration-300" />
                      </button>
                    </div>

                    <div className="flex-1 overflow-y-auto pr-2 custom-scrollbar">
                       <div className="flex flex-wrap gap-3 content-start">
                          {players.map((p, i) => (
                            <div key={i} className="flex items-center gap-3 bg-white/5 border border-white/10 pl-5 pr-2 py-3 rounded-2xl animate-fadeIn group hover:border-neon-blue/30 hover:bg-neon-blue/5 transition-all shadow-md">
                              <span className="font-bold text-lg text-white group-hover:text-neon-blue transition-colors">{p}</span>
                              <button 
                                  onClick={() => removePlayer(i)} 
                                  className="text-gray-500 hover:text-red-500 hover:bg-red-500/10 transition-colors rounded-xl p-2"
                              >
                                <X size={18} />
                              </button>
                            </div>
                          ))}
                          {players.length === 0 && (
                              <div className="w-full h-48 flex flex-col items-center justify-center text-gray-500 border-2 border-dashed border-white/5 rounded-3xl bg-black/20">
                                  <Users size={48} className="mb-4 opacity-30 text-neon-blue" />
                                  <p className="text-base font-medium">Nessun giocatore</p>
                                  <p className="text-sm opacity-60">Aggiungi almeno 3 giocatori</p>
                              </div>
                          )}
                       </div>
                    </div>
                  </div>

                  {/* Settings Group Column */}
                  <div className="space-y-6 flex flex-col">
                    
                    {/* Roles Settings */}
                    <div className="glass-panel p-6 md:p-8 rounded-[2rem] space-y-8 flex-1 border border-white/10 shadow-2xl">
                      <h3 className="text-sm font-bold text-gray-400 uppercase mb-2 flex items-center gap-2 tracking-wider">
                        <Settings size={18} className="text-neon-pink" /> Ruoli
                      </h3>

                      {/* Mister White Counter */}
                      <div className="flex items-center justify-between p-2 hover:bg-white/5 rounded-2xl transition-colors">
                        <div className="flex items-center gap-5">
                          <div className={`p-4 rounded-2xl transition-all duration-300 ${settings.mrWhiteCount > 0 ? 'bg-white text-black shadow-[0_0_20px_rgba(255,255,255,0.3)] scale-110' : 'bg-white/5 text-gray-500'}`}>
                            <HelpCircle size={28} />
                          </div>
                          <div>
                            <h3 className={`font-bold text-xl transition-colors ${settings.mrWhiteCount > 0 ? 'text-white' : 'text-gray-500'}`}>Mister White</h3>
                            <p className="text-sm text-gray-500 mt-1">Non conosce la parola</p>
                          </div>
                        </div>
                        <div className="flex items-center gap-4 bg-black/40 rounded-2xl p-2 border border-white/5">
                           <button className="w-12 h-12 flex items-center justify-center bg-white/5 rounded-xl hover:bg-white/20 text-white disabled:opacity-30 transition-colors" 
                            disabled={settings.mrWhiteCount === 0}
                            onClick={() => setSettings(s => ({...s, mrWhiteCount: Math.max(0, s.mrWhiteCount - 1)}))}>-</button>
                           <span className="font-display font-bold w-8 text-center text-white text-2xl">{settings.mrWhiteCount}</span>
                           <button className="w-12 h-12 flex items-center justify-center bg-white/5 rounded-xl hover:bg-white/20 text-white transition-colors"
                            onClick={() => setSettings(s => ({...s, mrWhiteCount: s.mrWhiteCount + 1}))}>+</button>
                        </div>
                      </div>

                      {/* Undercover Counter */}
                      <div className="flex items-center justify-between p-2 hover:bg-white/5 rounded-2xl transition-colors">
                        <div className="flex items-center gap-5">
                          <div className={`p-4 rounded-2xl transition-all duration-300 ${settings.undercoverCount > 0 ? 'bg-neon-pink text-black shadow-[0_0_20px_rgba(255,0,255,0.3)] scale-110' : 'bg-white/5 text-gray-500'}`}>
                            <VenetianMask size={28} />
                          </div>
                          <div>
                            <h3 className={`font-bold text-xl transition-colors ${settings.undercoverCount > 0 ? 'text-white' : 'text-gray-500'}`}>Infiltrati</h3>
                            <p className="text-sm text-gray-500 mt-1">Hanno parola diversa</p>
                          </div>
                        </div>
                        <div className="flex items-center gap-4 bg-black/40 rounded-2xl p-2 border border-white/5">
                           <button className="w-12 h-12 flex items-center justify-center bg-white/5 rounded-xl hover:bg-white/20 text-white disabled:opacity-30 transition-colors" 
                            disabled={settings.undercoverCount === 0}
                            onClick={() => setSettings(s => ({...s, undercoverCount: Math.max(0, s.undercoverCount - 1)}))}>-</button>
                           <span className="font-display font-bold w-8 text-center text-neon-pink text-2xl">{settings.undercoverCount}</span>
                           <button className="w-12 h-12 flex items-center justify-center bg-white/5 rounded-xl hover:bg-white/20 text-white transition-colors"
                            onClick={() => setSettings(s => ({...s, undercoverCount: s.undercoverCount + 1}))}>+</button>
                        </div>
                      </div>
                    </div>

                    {/* Timer Settings */}
                    <div className="glass-panel p-6 md:p-8 rounded-[2rem] space-y-6 flex-1 border border-white/10 shadow-2xl">
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-4">
                          <div className={`p-4 rounded-2xl transition-all duration-300 ${settings.timerEnabled ? 'bg-neon-green text-black shadow-[0_0_20px_rgba(10,255,0,0.3)]' : 'bg-white/5 text-gray-500'}`}>
                            <Timer size={28} />
                          </div>
                          <div>
                            <h3 className={`font-bold text-xl transition-colors ${settings.timerEnabled ? 'text-white' : 'text-gray-500'}`}>Timer</h3>
                            <p className="text-sm text-gray-500 mt-1">Tempo per discutere</p>
                          </div>
                        </div>
                        <label className="relative inline-flex items-center cursor-pointer">
                          <input type="checkbox" checked={settings.timerEnabled} onChange={e => setSettings({...settings, timerEnabled: e.target.checked})} className="sr-only peer" />
                          <div className="w-16 h-9 bg-gray-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-gray-400 after:border-gray-300 after:border after:rounded-full after:h-7 after:w-7 after:transition-all peer-checked:bg-neon-green peer-checked:after:bg-white"></div>
                        </label>
                      </div>

                      {settings.timerEnabled && (
                        <div className="flex items-center justify-between pl-2 animate-fadeIn bg-white/5 p-4 rounded-2xl border border-white/5">
                           <span className="text-base font-bold text-gray-300">Durata timer</span>
                           <div className="flex items-center gap-4">
                             <button className="w-10 h-10 flex items-center justify-center bg-white/10 rounded-lg hover:bg-white/20 text-white transition-colors" 
                              onClick={() => setSettings(s => ({...s, timerDuration: Math.max(30, s.timerDuration - 30)}))}>-</button>
                             <span className="font-display font-bold w-20 text-center text-neon-green text-xl tracking-wider">{formatTime(settings.timerDuration)}</span>
                             <button className="w-10 h-10 flex items-center justify-center bg-white/10 rounded-lg hover:bg-white/20 text-white transition-colors"
                              onClick={() => setSettings(s => ({...s, timerDuration: s.timerDuration + 30}))}>+</button>
                           </div>
                        </div>
                      )}
                    </div>
                  </div>
                </div>

                {!isValidConfig && players.length >= 3 && (
                  <div className="mt-8 p-4 bg-red-500/10 border border-red-500/20 rounded-2xl text-center backdrop-blur-md">
                    <p className="text-red-400 font-bold text-lg">
                      ⚠️ Configurazione non valida.
                      {totalImpostors === 0 ? " Aggiungi almeno un nemico." : " Troppi nemici per il numero di giocatori."}
                    </p>
                  </div>
                )}

              </div>
            ) : (
              <div className="flex-1 min-h-0 flex flex-col pb-24">
                <div className="glass-panel rounded-3xl overflow-hidden border border-white/10 flex-1 overflow-y-auto">
                  <table className="w-full text-left">
                    <thead className="bg-white/5 text-gray-400 text-xs uppercase tracking-widest sticky top-0 bg-dark-bg/90 backdrop-blur-md z-10">
                      <tr>
                        <th className="p-6 md:p-8">Rank</th>
                        <th className="p-6 md:p-8">Player</th>
                        <th className="p-6 md:p-8 text-right">Vittorie</th>
                        <th className="p-6 md:p-8 text-right hidden md:table-cell">Partite</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-white/5">
                      {leaderboard.map((entry, idx) => (
                        <tr key={entry.name} className="hover:bg-white/5 transition-colors group">
                          <td className="p-6 md:p-8 font-display font-bold text-gray-500 group-hover:text-white transition-colors text-lg">
                            {idx === 0 ? '🥇' : idx === 1 ? '🥈' : idx === 2 ? '🥉' : `#${idx + 1}`}
                          </td>
                          <td className="p-6 md:p-8 font-bold text-xl md:text-2xl">{entry.name}</td>
                          <td className="p-6 md:p-8 text-right font-display text-neon-blue text-2xl shadow-neon-blue drop-shadow-sm">{entry.wins}</td>
                          <td className="p-6 md:p-8 text-right font-display text-gray-500 hidden md:table-cell text-xl">{entry.matches}</td>
                        </tr>
                      ))}
                      {leaderboard.length === 0 && (
                        <tr><td colSpan={4} className="p-16 text-center text-gray-500 italic text-lg">Nessuna partita registrata</td></tr>
                      )}
                    </tbody>
                  </table>
                </div>
                
                {/* Reset Leaderboard Button */}
                {leaderboard.length > 0 && (
                   <div className="mt-6 flex justify-center">
                     <button 
                       onClick={handleClearLeaderboard}
                       className="flex items-center gap-2 px-6 py-3 bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 rounded-xl text-red-400 hover:text-red-200 transition-all text-sm uppercase font-bold tracking-wider"
                     >
                       <RotateCcw size={18} /> Azzera Classifica
                     </button>
                   </div>
                )}
              </div>
            )}

            {activeTab === 'setup' && (
              <div className="fixed bottom-0 left-0 w-full p-6 bg-gradient-to-t from-dark-bg via-dark-bg to-transparent z-30 pointer-events-none flex justify-center">
                <div className="w-full max-w-2xl pointer-events-auto">
                  <Button fullWidth onClick={handleStart} disabled={!isValidConfig} className="py-5 text-xl tracking-[0.2em] shadow-[0_0_40px_rgba(0,243,255,0.3)] hover:shadow-[0_0_60px_rgba(0,243,255,0.5)] border-t border-white/20">
                    INIZIA LA PARTITA
                  </Button>
                </div>
              </div>
            )}
          </div>
        );
      };

      // --- PassScreen ---
      const PassScreen = ({ player, onNext }) => {
        const [isFlipped, setIsFlipped] = useState(false);
        const [isTransitioning, setIsTransitioning] = useState(false);

        const handleCardClick = () => {
          if (isTransitioning) return;

          if (!isFlipped) {
            setIsFlipped(true);
          } else {
            setIsFlipped(false);
            setIsTransitioning(true);
            setTimeout(() => {
              setIsTransitioning(false);
              onNext();
            }, 700); 
          }
        };

        const getRoleIcon = () => {
          switch (player.role) {
            case Role.MR_WHITE: return <HelpCircle size={80} className="text-white" />;
            case Role.UNDERCOVER: return <VenetianMask size={80} className="text-neon-pink" />;
            default: return <User size={80} className="text-neon-blue" />;
          }
        };

        const getRoleName = () => {
          switch (player.role) {
            case Role.MR_WHITE: return "Mister White";
            case Role.UNDERCOVER: return "Infiltrato";
            default: return "Cittadino";
          }
        };

        return (
          <div className="h-full w-full flex flex-col items-center justify-center p-6 relative">
            <div className="text-center mb-10 animate-float">
              <h2 className="text-gray-400 uppercase tracking-[0.3em] text-sm md:text-base mb-3">Turno di</h2>
              <h1 className="font-display text-5xl md:text-6xl font-black text-white transition-opacity duration-300 drop-shadow-xl">
                 {player.name}
              </h1>
            </div>

            <div 
              className="w-full max-w-[320px] md:max-w-[420px] aspect-[3/4] cursor-pointer group perspective-1000"
              onClick={handleCardClick}
            >
              <div className={`relative w-full h-full duration-700 transition-all card-preserve-3d ${isFlipped ? 'rotate-y-180' : ''}`}>
                {/* FRONT */}
                <div className="absolute inset-0 w-full h-full card-backface-hidden">
                  <div className="w-full h-full glass-panel rounded-[2.5rem] border-2 border-neon-blue/30 flex flex-col items-center justify-center p-10 shadow-[0_0_30px_rgba(0,243,255,0.1)] group-hover:shadow-[0_0_60px_rgba(0,243,255,0.3)] transition-shadow bg-dark-card/50">
                    <div className="w-32 h-32 rounded-full bg-neon-blue/10 flex items-center justify-center mb-8 animate-pulse-slow ring-1 ring-neon-blue/30">
                      <Eye size={64} className="text-neon-blue" />
                    </div>
                    <h3 className="font-display text-3xl font-bold text-center mb-4 tracking-wider">TOCCA PER<br/>RIVELARE</h3>
                    <p className="text-gray-400 text-center text-sm md:text-base max-w-[80%]">Assicurati che nessun altro stia guardando lo schermo</p>
                  </div>
                </div>

                {/* BACK */}
                <div className="absolute inset-0 w-full h-full card-backface-hidden rotate-y-180">
                  <div className={`w-full h-full glass-panel rounded-[2.5rem] border-2 flex flex-col items-center justify-center p-10 shadow-2xl bg-dark-card/80 backdrop-blur-xl ${
                    player.role === Role.CIVILIAN ? 'border-neon-blue/50 shadow-neon-blue/20' : 
                    player.role === Role.UNDERCOVER ? 'border-neon-pink/50 shadow-neon-pink/20' : 
                    'border-white/50 shadow-white/20'
                  }`}>
                    <div className="mb-8 transform scale-110">
                      {getRoleIcon()}
                    </div>
                    
                    <h3 className="font-display text-2xl font-bold mb-10 opacity-80 tracking-[0.2em] uppercase">
                      {getRoleName()}
                    </h3>

                    <div className="w-full bg-black/40 rounded-2xl p-8 text-center border border-white/5 mb-10 shadow-inner">
                      <p className="text-xs text-gray-500 uppercase mb-3 tracking-wider">La tua parola segreta</p>
                      <p className="font-display text-4xl md:text-5xl font-black tracking-wider break-words text-white drop-shadow-lg">
                        {player.role === Role.MR_WHITE ? "???" : player.word}
                      </p>
                    </div>

                    <div className="mt-auto flex flex-col items-center text-gray-400">
                      <EyeOff size={28} className="mb-2" />
                      <span className="text-xs uppercase tracking-[0.2em]">Tocca per nascondere</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // --- GameScreen ---
      const GameScreen = ({ players, onEliminate, gameStatus, setGameStatus, settings }) => {
        const [timeLeft, setTimeLeft] = useState(settings.timerDuration);
        const [selectedPlayer, setSelectedPlayer] = useState(null);

        useEffect(() => {
          let interval;
          if (settings.timerEnabled && gameStatus === 'playing' && timeLeft > 0) {
            interval = setInterval(() => {
              setTimeLeft((prev) => prev - 1);
            }, 1000);
          }
          return () => clearInterval(interval);
        }, [gameStatus, timeLeft, settings.timerEnabled]);

        const handlePlayerClick = (id) => {
          if (gameStatus === 'voting') {
            const p = players.find(pl => pl.id === id);
            if (p && p.isAlive) {
              setSelectedPlayer(id);
            }
          }
        };

        const confirmElimination = () => {
          if (selectedPlayer) {
            onEliminate(selectedPlayer);
            setSelectedPlayer(null);
          }
        };

        const formatTime = (seconds) => {
          const m = Math.floor(seconds / 60);
          const s = seconds % 60;
          return `${m}:${s.toString().padStart(2, '0')}`;
        };

        return (
          <div className="h-full w-full flex flex-col p-6">
            {/* Top Bar */}
            <div className="flex justify-between items-center mb-8 sticky top-0 z-20 bg-dark-bg/80 backdrop-blur-sm py-4">
              {settings.timerEnabled ? (
                <div className="px-6 py-3 bg-white/5 rounded-xl border border-white/10 backdrop-blur-md shadow-lg">
                  <span className={`font-display font-bold text-3xl ${timeLeft < 10 ? 'text-red-500 animate-pulse' : 'text-white'}`}>
                    {gameStatus === 'playing' ? formatTime(timeLeft) : 'VOTAZIONE'}
                  </span>
                </div>
              ) : (
                 <div className="px-6 py-3 bg-white/5 rounded-xl border border-white/10 backdrop-blur-md shadow-lg">
                   <span className="font-display font-bold text-lg text-neon-blue tracking-wider">
                      {gameStatus === 'playing' ? 'IN CORSO' : 'VOTAZIONE'}
                   </span>
                 </div>
              )}
              
              <div className="text-sm font-medium text-right text-gray-400 bg-black/20 px-4 py-2 rounded-lg">
                <p className="mb-1"><span className="text-green-400">●</span> VIVI: {players.filter(p => p.isAlive).length}</p>
                <p><span className="text-red-500">●</span> ELIMINATI: {players.filter(p => !p.isAlive).length}</p>
              </div>
            </div>

            {/* Grid */}
            <div className="flex-1 overflow-y-auto pb-32">
              <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6 lg:gap-8 content-start">
                {players.map((p) => (
                  <div 
                    key={p.id}
                    onClick={() => handlePlayerClick(p.id)}
                    className={`
                      relative aspect-square rounded-3xl p-4 flex flex-col items-center justify-center text-center transition-all duration-300 border-2 group
                      ${!p.isAlive ? 'opacity-40 grayscale border-gray-800 bg-black/50' : ''}
                      ${gameStatus === 'voting' && p.isAlive ? 'cursor-pointer hover:scale-[1.02] active:scale-95 animate-pulse-slow hover:shadow-neon-blue/20 hover:border-neon-blue/50' : ''}
                      ${selectedPlayer === p.id ? 'border-red-500 bg-red-500/10 shadow-[0_0_30px_rgba(239,68,68,0.3)] scale-[0.98]' : 'border-white/5 bg-white/5 hover:bg-white/10'}
                    `}
                  >
                    {/* Starter Badge */}
                    {p.isStarter && (
                      <div className="absolute top-3 right-3 text-yellow-400 drop-shadow-md" title="Primo giocatore">
                        <Crown size={20} fill="currentColor" />
                      </div>
                    )}

                    {/* Avatar */}
                    <div className={`
                      w-16 h-16 md:w-20 md:h-20 rounded-full mb-4 flex items-center justify-center text-3xl md:text-4xl font-bold shadow-xl ring-4 ring-black/20
                      ${!p.isAlive ? 'bg-gray-800 text-gray-500' : 'bg-gradient-to-br from-indigo-500 to-purple-600 text-white'}
                    `}>
                      {!p.isAlive ? <Skull size={28} /> : p.name.charAt(0).toUpperCase()}
                    </div>

                    {/* Name */}
                    <h3 className={`
                      font-display font-black leading-tight break-words w-full px-2
                      ${p.name.length > 8 ? 'text-lg md:text-xl' : 'text-2xl md:text-3xl'}
                      ${p.isAlive ? 'text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-300 group-hover:from-neon-blue group-hover:to-white transition-all' : 'text-gray-500 line-through decoration-red-500 decoration-2'}
                    `}>
                      {p.name}
                    </h3>

                    {/* Status */}
                    {!p.isAlive && (
                      <span className="text-xs md:text-sm text-red-500 font-bold uppercase tracking-widest mt-2 border border-red-500/30 px-2 py-0.5 rounded-full">
                        ELIMINATO
                      </span>
                    )}

                    {/* Selection Indicator */}
                    {selectedPlayer === p.id && (
                      <div className="absolute inset-0 rounded-3xl border-4 border-red-500 animate-pulse pointer-events-none"></div>
                    )}
                  </div>
                ))}
              </div>
            </div>

            {/* Action Bar */}
            <div className="fixed bottom-0 left-0 w-full p-6 bg-gradient-to-t from-dark-bg via-dark-bg to-transparent z-30">
              <div className="max-w-2xl mx-auto">
                {gameStatus === 'playing' ? (
                  <Button 
                    fullWidth 
                    variant="danger" 
                    className="text-lg py-5 shadow-2xl"
                    onClick={() => {
                      setGameStatus('voting');
                      setTimeLeft(0);
                    }}
                  >
                    AVVIA VOTAZIONE
                  </Button>
                ) : (
                  <div className="space-y-4">
                    <div className="bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex items-center gap-4 justify-center backdrop-blur-md">
                      <AlertTriangle className="text-red-500 flex-shrink-0 w-6 h-6" />
                      <p className="text-base md:text-lg text-red-100 font-medium">
                        {selectedPlayer 
                          ? <span>Vuoi eliminare <span className="font-bold text-white underline decoration-red-500">{players.find(p => p.id === selectedPlayer)?.name}</span>?</span>
                          : "Seleziona un giocatore da eliminare"}
                      </p>
                    </div>
                    <Button 
                      fullWidth 
                      variant="danger" 
                      className="text-lg py-5 shadow-2xl"
                      disabled={!selectedPlayer} 
                      onClick={confirmElimination}
                    >
                      ELIMINA GIOCATORE
                    </Button>
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      };

      // --- App ---
      const App = () => {
        const [phase, setPhase] = useState(GamePhase.SETUP);
        const [players, setPlayers] = useState([]);
        const [turnIndex, setTurnIndex] = useState(0);
        const [civilianWord, setCivilianWord] = useState('');
        const [gameStatus, setGameStatus] = useState('playing');
        const [winners, setWinners] = useState(null);
        
        const [currentSettings, setCurrentSettings] = useState({
          mrWhiteCount: 1,
          undercoverCount: 1,
          timerEnabled: true,
          timerDuration: 60
        });

        const startGame = (names, settings) => {
          setCurrentSettings(settings);

          let originalPair = getNewWordPair();

          if (!originalPair) {
            const shouldReset = window.confirm(
              "🎉 Complimenti! Hai giocato tutte le parole disponibili nel database!\n\nVuoi resettare la memoria e ricominciare da capo con le stesse parole?"
            );

            if (shouldReset) {
              resetUsedWordsHistory();
              originalPair = getNewWordPair();
            } else {
              return; 
            }
          }

          if (!originalPair) return;

          // ============================================
          // MODIFICA AUTOMATICA (SHUFFLE/RANDOMIZE)
          // ============================================
          let pair = { ...originalPair };
          // 50% di possibilità di invertire le parole
          if (Math.random() < 0.5) {
             pair = {
               civilian: originalPair.undercover,
               undercover: originalPair.civilian
             };
          }
          // ============================================

          setCivilianWord(pair.civilian);

          let roles = [];
          // Add Mr. Whites based on count
          for (let i = 0; i < settings.mrWhiteCount; i++) roles.push(Role.MR_WHITE);
          // Add Undercovers
          for (let i = 0; i < settings.undercoverCount; i++) roles.push(Role.UNDERCOVER);
          
          while (roles.length < names.length) roles.push(Role.CIVILIAN);
          
          roles = shuffleArray(roles);

          const newPlayers = names.map((name, i) => ({
            id: `p-${i}-${Date.now()}`,
            name: name,
            role: roles[i],
            word: roles[i] === Role.CIVILIAN ? pair.civilian : (roles[i] === Role.UNDERCOVER ? pair.undercover : undefined),
            isAlive: true,
            isStarter: false
          }));

          const starterIndex = Math.floor(Math.random() * newPlayers.length);
          newPlayers[starterIndex].isStarter = true;

          const shuffledForTurn = shuffleArray([...newPlayers]);

          setPlayers(shuffledForTurn);
          setTurnIndex(0);
          setGameStatus('playing');
          setPhase(GamePhase.PASS_PHONE);
        };

        const handleNextPlayer = () => {
          if (turnIndex < players.length - 1) {
            setTurnIndex(turnIndex + 1);
          } else {
            setPhase(GamePhase.GAMEPLAY);
          }
        };

        const handleEliminate = (playerId) => {
          const eliminatedPlayer = players.find(p => p.id === playerId);
          if (!eliminatedPlayer) return;

          const updatedPlayers = players.map(p => 
            p.id === playerId ? { ...p, isAlive: false } : p
          );
          setPlayers(updatedPlayers);

          if (eliminatedPlayer.role === Role.MR_WHITE) {
            setTimeout(() => {
              const guess = prompt(`Mister White (${eliminatedPlayer.name}) è stato scoperto! Ha una chance per vincere.\n\nQual è la parola segreta dei Civili?`);
              
              if (guess && guess.toLowerCase().trim() === civilianWord.toLowerCase().trim()) {
                 handleGameOver('Mr. White', [eliminatedPlayer.name]);
                 return;
              } else {
                 alert("Sbagliato! La parola era: " + civilianWord);
                 checkWinCondition(updatedPlayers);
              }
            }, 100);
          } else {
            checkWinCondition(updatedPlayers);
          }
          
          setGameStatus('playing');
        };

        const checkWinCondition = (currentPlayers) => {
          const alive = currentPlayers.filter(p => p.isAlive);
          const civilians = alive.filter(p => p.role === Role.CIVILIAN);
          const impostors = alive.filter(p => p.role !== Role.CIVILIAN);

          if (impostors.length >= civilians.length) {
            const impostorNames = players.filter(p => p.role !== Role.CIVILIAN).map(p => p.name);
            handleGameOver('Impostori', impostorNames);
            return;
          }

          if (impostors.length === 0) {
            const civilianNames = players.filter(p => p.role === Role.CIVILIAN).map(p => p.name);
            handleGameOver('Cittadini', civilianNames);
            return;
          }
        };

        const triggerConfetti = () => {
          const duration = 3000;
          const end = Date.now() + duration;

          const frame = () => {
            confetti({
              particleCount: 2,
              angle: 60,
              spread: 55,
              origin: { x: 0 },
              colors: ['#00f3ff', '#ff00ff', '#ffffff']
            });
            confetti({
              particleCount: 2,
              angle: 120,
              spread: 55,
              origin: { x: 1 },
              colors: ['#00f3ff', '#ff00ff', '#ffffff']
            });

            if (Date.now() < end) {
              requestAnimationFrame(frame);
            }
          };
          frame();
        };

        const handleGameOver = (winningTeam, winnerNames) => {
          setPhase(GamePhase.GAME_OVER);
          triggerConfetti();
          
          let icon = <Trophy size={80} className="text-yellow-400" />;
          if (winningTeam === 'Impostori') icon = <div className="text-7xl">👺</div>;
          
          setWinners({ team: winningTeam, icon });
          updateLeaderboard(winnerNames, players.map(p => p.name));
        };

        return (
          <div className="w-full min-h-screen bg-dark-bg text-white font-sans overflow-x-hidden flex flex-col items-center">
            <div className="fixed top-[-20%] left-[-20%] w-[50vw] h-[50vw] bg-neon-blue/10 rounded-full blur-[120px] pointer-events-none animate-pulse-slow z-0"></div>
            <div className="fixed bottom-[-20%] right-[-20%] w-[50vw] h-[50vw] bg-neon-pink/10 rounded-full blur-[100px] pointer-events-none animate-pulse-slow z-0" style={{ animationDelay: '1.5s' }}></div>

            <div className="relative z-10 w-full h-full flex-1 flex flex-col max-w-7xl mx-auto">
              
              {phase === GamePhase.SETUP && (
                <div className="flex-1 flex items-center justify-center p-4">
                   <SetupScreen onStartGame={startGame} />
                </div>
              )}

              {phase === GamePhase.PASS_PHONE && (
                 <div className="flex-1 flex items-center justify-center p-4">
                   <PassScreen 
                    player={players[turnIndex]} 
                    onNext={handleNextPlayer} 
                    civilianWord={civilianWord}
                  />
                 </div>
              )}

              {phase === GamePhase.GAMEPLAY && (
                <GameScreen 
                  players={players} 
                  onEliminate={handleEliminate} 
                  gameStatus={gameStatus} 
                  setGameStatus={setGameStatus} 
                  settings={currentSettings} 
                />
              )}

              {phase === GamePhase.GAME_OVER && winners && (
                <div className="flex-1 flex flex-col items-center justify-center p-8 text-center animate-fadeIn max-w-lg mx-auto">
                  <div className="mb-8 animate-bounce drop-shadow-[0_0_15px_rgba(255,215,0,0.5)]">
                    {winners.icon}
                  </div>
                  <h2 className="text-gray-400 uppercase tracking-[0.3em] text-lg mb-4">Vittoria</h2>
                  <h1 className="font-display text-6xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-neon-blue to-neon-pink mb-12 drop-shadow-2xl">
                    {winners.team}
                  </h1>
                  
                  <div className="glass-panel p-8 rounded-3xl w-full mb-12 transform hover:scale-105 transition-transform duration-300">
                    <h3 className="text-sm text-gray-400 mb-4 uppercase tracking-wider">Parola Segreta</h3>
                    <p className="text-4xl font-bold text-white tracking-wide">{civilianWord}</p>
                  </div>

                  <div className="space-y-4 w-full">
                    <Button fullWidth onClick={() => setPhase(GamePhase.SETUP)}>
                      <Home className="inline-block mr-2" size={24} />
                      Torna al Menu
                    </Button>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
